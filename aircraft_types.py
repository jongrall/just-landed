#!/usr/bin/env python

"""aircraft_types.py: Utilities for mapping aircraft codes to simplified types."""

__author__ = "Jon Grall"
__copyright__ = "Copyright 2012, Just Landed LLC"
__email__ = "jon@littledetails.net"

aircraft_types = {
    'JET2': [
        'A306',
        'A30B',
        'A310',
        'A318',
        'A319',
        'A320',
        'A321',
        'A332',
        'A333',
        'B731',
        'B732',
        'B733',
        'B734',
        'B735',
        'B736',
        'B737',
        'B738',
        'B739',
        'B73Q',
        'B752',
        'B753',
        'B762',
        'B763',
        'B764',
        'B772',
        'B773',
        'MD11',
        'R721',
        'R722',
    ],
    'JET2REAR': [
        'B712',
        'B721',
        'B722',
        'B72Q',
        'RJ1',
        'CRJ2',
        'CRJ7',
        'CRJ9',
        'DC91',
        'DC91',
        'DC92',
        'DC92',
        'DC93',
        'DC93',
        'DC94',
        'DC94',
        'DC95',
        'DC95',
        'DC9Q',
        'DC9Q',
        'LJ23',
        'LJ24',
        'LJ24',
        'LJ25',
        'LJ25',
        'LJ28',
        'LJ31',
        'LJ31',
        'LJ35',
        'LJ35',
        'LJ35',
        'LJ40',
        'LJ45',
        'LJ55',
        'LJ55',
        'LJ60',
        'MD81',
        'MD82',
        'MD83',
        'MD87',
        'MD88',
        'MD90',
    ],
    'JET4': [
        'A342',
        'A343',
        'A345',
        'A346',
        'A380',
        'B720',
        'B741',
        'B742',
        'B743',
        'B744',
        'B74D',
        'B74R',
        'B74S',
        'C135',
        'C141',
        'YC15',
        'DC85',
        'DC85',
        'DC86',
        'DC86',
        'DC87',
        'DC87',
        'DC8Q',
        'DC8Q',
        'E3CF',
        'E3TF',
    ],
    'PROP4': [
        'C130',
        'C133',
        'C97',
        'DC4',
        'DC6',
        'DC7',
    ],
}

iata_aircraft_types = {
    'JET2': [
        '310',
        '312',
        '313',
        '318',
        '319',
        '31F',
        '31X',
        '31Y',
        '320',
        '321',
        '330',
        '332',
        '333',
        '731',
        '732',
        '733',
        '734',
        '735',
        '736',
        '737',
        '738',
        '739',
        '73C',
        '73F',
        '73G',
        '73H',
        '73M',
        '73W',
        '73X',
        '73Y',
        '73Z',
        '752',
        '753',
        '757',
        '75F',
        '75M',
        '75W',
        '75X',
        '762',
        '763',
        '764',
        '767',
        '76F',
        '76X',
        '76Y',
        '772',
        '773',
        '777',
        '77L',
        '77W',
        'A81',
        'AB2',
        'AB3',
        'AB4',
        'AB6',
        'ABB',
        'ABF',
        'ABM',
        'ABX',
        'ABY',
        'D10',
        'D11',
        'D14',
        'D1C',
        'D1F',
        'D1M',
        'D1X',
        'D1Y',
        'E70',
        'E75',
        'E90',
        'E95',
        'EMJ',
        'FRJ',
        'M11',
        'M1F',
        'M1M',
        'T20',
        
    ],
    'JET2REAR': [
        '100',
        '717',
        '721',
        '722',
        '727',
        '72B',
        '72C',
        '72F',
        '72M',
        '72S',
        '72X',
        '72Y',
        'AMD',
        'B11',
        'B12',
        'B13',
        'B14',
        'B15',
        'BE4',
        'CCJ',
        'CCX',
        'CNJ',
        'CR1',
        'CR2',
        'CR7',
        'CR9',
        'CRJ',
        'CRV',
        'D91',
        'D92',
        'D93',
        'D94',
        'D95',
        'D9C',
        'D9F',
        'D9X',
        'DC9',
        'DF2',
        'DF3',
        'DFL',
        'ER3',
        'ER4',
        'ERD',
        'ERJ',
        'F21',
        'F22',
        'F23',
        'F24',
        'F27',
        'F28',
        'F70',
        'GRJ',
        'GRM',
        'H25',
        'IL6',
        'LRJ',
        'M80',
        'M81',
        'M82',
        'M83',
        'M87',
        'M88',
        'M90',
        'NDC',
        'SSC',
        'TU3',
        'TU5',
        'WWP',
        'YK2',
        'YK4',
        
        
    ],
    'JET4': [
        '141',
        '142',
        '143',
        '146',
        '14F',
        '14X',
        '14Y',
        '14Z',
        '340',
        '342',
        '343',
        '345',
        '346',
        '380',
        '38F',
        '703',
        '707',
        '70F',
        '70M',
        '741',
        '742',
        '743',
        '744',
        '747',
        '74C',
        '74D',
        '74E',
        '74F',
        '74H',
        '74J',
        '74L',
        '74M',
        '74R',
        '74T',
        '74U',
        '74V',
        '74X',
        '74Y',
        'A4F',
        'AR1',
        'AR7',
        'AR8',
        'ARJ',
        'B72',
        'D8F',
        'D8L',
        'D8M',
        'D8Q',
        'D8T',
        'D8X',
        'D8Y',
        'DC8',
        'I93',
        'I9F',
        'I9M',
        'I9X',
        'I9Y',
        'IL7',
        'IL9',
        'ILW', 
    ],
    'PROP2': [
        'A26',
        'A28',
        'A30',
        'A32',
        'A40',
        'ACD',
        'ACP',
        'ACT',
        'ALM',
        'AN2',
        'AN4',
        'AN6',
        'AN7',
        'AT4',
        'AT5',
        'AT7',
        'ATD',
        'ATP',
        'ATR',
        'BE1',
        'BE2',
        'BE9',
        'BEC',
        'BEH',
        'BEP',
        'BES',
        'BET',
        'BNI',
        'BNT',
        'CD2',
        'CN1',
        'CN2',
        'CNA',
        'CNC',
        'CNT',
        'CS2',
        'CS5',
        'CV4',
        'CV5',
        'CVF',
        'CVR',
        'CVV',
        'CVX',
        'CVY',
        'CWC',
        'D28',
        'D38',
        'D3F',
        'DC3',
        'DH1',
        'DH2',
        'DH3',
        'DH4',
        'DH8',
        'DHB',
        'DHC',
        'DHD',
        'DHL',
        'DHO',
        'DHP',
        'DHR',
        'DHS',
        'DHT',
        'EM2',
        'EMB',
        'F50',
        'FK7',
        'GRG',
        'GRS',
        'HEC',
        'HS7',
        'I14',
        'J31',
        'J32',
        'J41',
        'JST',
        'JU5',
        'L10',
        'L11',
        'L15',
        'L1F',
        'L4T',
        'MU2',
        'ND2',
        'PA1',
        'PA2',
        'PAG',
        'PAT',
        'PL2',
        'PL6',
        'PN6',
        'S20',
        'SF3',
        'SH3',
        'SH6',
        'SC7',
        'SWM',
        'YN2',
        'YN7',
        'YS1',
    ],
    'PROP4': [
        'ANF',
        'CL4',
        'D6F',
        'DC6',
        'DH7',
        'DHH',
        'IL8',
        'L49',
        'LOE',
        'LOF',
        'LOH',
        'LOM',
        'SHB',
        'VCV',
    ],   
}

# Invert the mapping type => major_type
type_mapping = {}
for major_type in aircraft_types.keys():
    subtypes = aircraft_types[major_type]
    for minor_type in subtypes:
        type_mapping[minor_type] = major_type

# Invert the mapping type => major_type
iata_type_mapping = {}
for major_type in iata_aircraft_types.keys():
    subtypes = iata_aircraft_types[major_type]
    for minor_type in subtypes:
        iata_type_mapping[minor_type] = major_type

def type_to_major_type(aircraft_type, iata=False):
    """Converts a specific aircraft model to a broader design categorization."""
    if not aircraft_type:
        return 'JET2'
    match = None
    if iata:
        match = iata_type_mapping.get(aircraft_type)
    else:
        match = type_mapping.get(aircraft_type)
    return match or 'PROP2'